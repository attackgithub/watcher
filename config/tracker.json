{
    "harvester": {
        "brokers": [ "192.168.180.104:9092" ],
        "topics": [ "api_gate", "test1", "test2", "sql" ],
        "group": "tracker"
    },
    "editor": [
    {
        "topics": [ "sql" ],
        "model": "json"
    },
    {
        "topics": [ "sql" ],
        "model": "json",
        "data": {
            "fields": ["json_data"]
        }
    },
    {
        "topics": [ "api_gate" ],
        "model": "regexp",
        "data": {
            "regexp": "(\\d{4}/\\d{2}/\\d{2}\\s\\d{2}:\\d{2}:\\d{2})\\s\\[(.*)\\]\\suser:(\\w+)\\s(.*)",
            "fields": [ "date", "level", "user", "sql" ]
        }
    },
    {
        "topics": [ "sql" ],
        "model": "remove",
        "data": {
            "fields": [ "id", "file", "info", "message", "user", "json_data"]
        }
    }
    ],
        "processor": [
        {
            "topics": [ "sql" ],
            "rules": [
            {
                "model": "check_action",
                "match": [ 
                {
                    "key": "sql_action",
                    "method": "equal",
                    "value": "delete"
                }, {
                    "key": "sql_user",
                    "method": "equal",
                    "value": "mysql_ro"
                } ],
                "action": {
                    "mail": true,
                    "break": true
                }
            },
            {
                "model": "check_where",
                "match": [ 
                {
                    "key": "sql_action",
                    "method": "equal",
                    "value": "update"
                }, 
                {
                    "key": "sql_where",
                    "method": "equal",
                    "value": ""
                } ],
                "action": {
                    "mail": true,
                    "break": false
                }
            }
            ]
        },
        {
            "topics": [ "api_gate" ],
            "rules": [
            {
                "model": "common",
                "match": [ 
                {
                    "key": "user",
                    "method": "equal",
                    "value": "mysql_rw"
                } ],
                "action": {
                    "mail": true,
                    "break": true
                }
            }
            ]
        },
        {
            "topics": [ "api_gate" ],
            "rules": [
            {
                "model": "common",
                "match": [ 
                {
                    "key": "level",
                    "method": "equal",
                    "value": "error"
                } ],
                "action": {
                    "mail": true,
                    "break": true
                }
            }
            ]
        },
        {
            "topics": [ "api_gate" ],
            "rules": [
            {
                "model": "regexp",
                "match": [ 
                {
                    "key": "level",
                    "method": "match",
                    "value": "**"
                } ],
                "action": {
                    "mail": true,
                    "break": true
                }
            }
            ]
        }
    ]
}
